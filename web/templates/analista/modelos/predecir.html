{% include 'components/header.html' %} {% with menu='modelos' %} {% include
'components/sidebar.html' %} {% endwith %}

<span>
  <h4 class="ml-1 d-inline-block">Predecir</h4>
  <i class="fa fa-flask fa-lg ml-1"></i>
</span>

<form
  id="conjuntoForm"
  action="{{url_for('Conjunto.crear')}}"
  method="POST"
  enctype="multipart/form-data"
  data-toggle="validator"
  class="jumbotron py-4 pr-2 bg-light"
  style="width: 90%"
>
  <div class="container">
    <div class="form-group row">
      <div class="col-sm-5">
        <label id="facultad_label">
          <i class="fa fa-university"></i>
          Facultad
        </label>
        <input
          class="form-control"
          name="facultad"
          value="{{modelo.resultados.facultad}}"
          required
          readonly
        />
      </div>
      <div class="col-sm-6">
        <label id="programa_label">
          <i class="fa fa-graduation-cap"></i>
          Programa
        </label>

        <input
          id="programa"
          value="{{modelo.resultados.idprograma}}"
          hidden
        />
        <input
          class="form-control"
          name="programa"
          
          value="{{modelo.resultados.programa}}"
          required
          readonly
        />
      </div>
    </div>
    <div class="form-group row">
      <div class="col-sm-2">
        <label>
          <i class="fa fa-calendar"></i>
          Periodo Inicial
        </label>
        <select
          name="periodoInicial"
          id="periodoInicialID"
          class="periodos-controls form-control input-sm"
          required
        >
          <option disabled selected hidden></option>
        </select>
      </div>
      <div class="col-sm-2">
        <label>
          <i class="fa fa-calendar-alt"></i>
          Periodo Final
        </label>
        <select
          name="periodoFinal"
          id="periodoFinalID"
          class="periodos-controls form-control input-sm"
          required
        >
          <option disabled selected hidden></option>
        </select>
      </div>
      <script>
        //LLenar con periodos del programa

        $.ajax({
          url: "periodos/" + $("#programa").val(),
          type: "GET",
          contentType: "application/json;charset=UTF-8",
          data: {},
          dataType: "json",
          success: function (data) {
            var periodoInicial = document.getElementById("periodoInicialID");
            var periodoFinal = document.getElementById("periodoFinalID");
            var i = 1;
            data.forEach((p) => {
              periodoInicial.options[i] = new Option(p, p);
              periodoFinal.options[i] = new Option(p, p);
              i = i + 1;
            });
          },
        });

        // Validar Periodo
        $(".periodos-controls").on("change", function () {
          if ($("#periodoInicialID").val() >= $("#periodoFinalID").val()) {
            $("#periodoInicialID")[0].setCustomValidity("Periodo Invalido");
          } else {
            $("#periodoInicialID")[0].setCustomValidity("");
          }

          if ($("#periodoFinalID").val() <= $("#periodoInicialID").val()) {
            $("#periodoFinalID")[0].setCustomValidity("Periodo Invalido");
          } else {
            $("#periodoFinalID")[0].setCustomValidity("");
          }
        });
      </script>

    </div>

    <!--Boton para validar campos-->
    <br />
    <div class="text-center">
      <button
        id="btn-submit"
        type="submit"
        class="btn btn-dark text-white my-primary submit"
      >
        Predecir
        <i class="fas fa-flask fa-sm ml-1"></i>
      </button>
      <button
        class="btn btn-dark text-white my-primary btn-loading"
        type="button"
        style="display: none"
      >
        <i
          class="fas fa-spinner fa-spin fa-lg text-white"
          aria-hidden="true"
        ></i>
        Cargando...
      </button>
    </div>
  </div>
</form>

<script>
  // Boton cargando si se esta validando y guardando la data del conjunto
  $("#btn-submit").click(function () {
    var validacion = $("#conjuntoForm")[0].checkValidity();
    if (validacion == true) {
      handleModal(
        "Su conjunto aparecera cuando acabe el proceso (recuerde refrescar la p√°gina)",
        "{{url_for('Conjunto.crudos')}}"
      );
    }
  });
</script>

{% include 'components/footer.html' %}
