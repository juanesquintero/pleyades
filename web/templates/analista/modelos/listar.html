{% include 'components/header.html' %}


{% include 'components/sidebar.html' %}


<h4>Modelos de Deserci칩n</h4>
<br>

<!-- Input de filtrado -->
<div class="row ml-1 mt-2">
  &nbsp;<i class="fas fa-filter mr-2 mt-2"></i>&nbsp;
  <input type="text" class="form-control form-control-sm w-25" id="filtro_tabla" placeholder="Filtrar tabla...">
</div>
<br>


<!-- Tabla -->
<div class="table-responsive-sm ">
  <table class="table table-hover table-sm" id="tabla">
    <thead>
      <tr class="border-top-0">
        <th scope="col" class="border-top-0">
          <center>Nombre</center>
        </th>
        <th scope="col" class="border-top-0">
          <center>Programa</center>
        </th>
        <th scope="col" class="border-top-0">
          <center>Clasificador</center>
        </th>
        <th scope="col" class="border-top-0">
          <center>Precisi칩n</center>
        </th>
        <th scope="col" class="border-top-0">
          <center>Deserci칩n Estimada</center>
        </th>
        <th scope="col" class="border-top-0">
          <center> Acciones</center>
        </th>
      </tr>
    </thead>
    <tbody>

      {% for m in modelos %}
      <tr>
        <td>
          <center>{{ m.conjunto }}</center>
        </td>
        <td>
          
          {% for p in programas %}
          
            {% set prgm = m.conjunto.split(' ')[0] %}
            
            {% if prgm==p.nombre_corto %}
              <center>{{p.nombre}}</center>
            {% endif %}
          
            {% endfor %}

        </td>
        <td>
          <center>{{ m.resultados.clasificador }}</center>
        </td>

        <td>
          <center>{{ m.resultados.precision }} %</center>
        </td>

        <td>
          <center>{{ m.resultados.desercion_prevista }} %</center> 
        </td>

        <td>
          <!-- ACCCIONES -->
          <div class="row d-flex justify-content-center">

            <!-- PREDECIR -->
            <form action="{{url_for('Analista.predecir')}}" method="POST">
              <input type="hidden" name="modelo" value="{{m}}">
              <!-- Boton para predecir con un modelo -->
              <button 
                  type="submit" data-toggle="tooltip" data-placement="bottom" title="Predecir"
                  class="btn btn-primary btn-sm submit" role="status">
                  
                  <!-- <i 
                    class="fa fa-solid fa-play f-lg"
                    aria-hidden="true" 
                  ></i> -->
                  <i 
                    class="fa fa-flask fa-lg"  
                    aria-hidden="true"
                  ></i>
                
              </button>
              
              <button class="btn btn-outline-dark btn-sm btn-loading" type="button" style="display: none;">
                <i class="fas fa-spinner fa-spin fa-lg" aria-hidden="true"></i>
              </button>

            </form>

            &nbsp;

            <!-- DESCARGAR-->
            <form action="{{url_for('Analista.descargar')}}" method="POST">
              <input type="hidden" name="modelo" value="{{m}}">
              <button type="submit" data-toggle="tooltip" data-placement="bottom" title="Descargar Archivo"
                class="btn btn-outline-dark btn-sm submit" role="status">
                <i class="fa fa-solid fa-arrow-down"></i>
              </button>
            </form>

          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

</div>

{% if error %}
<br>
{% with titulo='No se pudieron cargar los modelos',error=error %}
{% include "components/alert.html" %}
{% endwith %}
<br>
{% endif %}


<br>

<a href="{{url_for('Analista.entrenar') }}" type="button" class="btn btn-dark text-white my-primary mt-4">
  Nuevo
  <i class="fa fa-robot ml-1"></i>
</a>

<script>
  // Cargando si se esta validando y guardando la data del modelo 
  $('.submit').click(function () {
    handleModal('Su modelo aparecera cuando acabe el proceso (recuerde refrescar la p치gina)', "{{url_for('Analista.predicciones')}}")
  })
</script>

{% include 'components/footer.html' %}